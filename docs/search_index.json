[["index.html", "Unidad 2 — Análisis temporal (PIB per cápita) + CO₂ opcional Capítulo 1 Propuesta 1.1 Tema y variable 1.2 Justificación 1.3 Fuentes y permisos 1.4 Entregables", " Unidad 2 — Análisis temporal (PIB per cápita) + CO₂ opcional Angel David Sanchez Serna 2025-10-20 Capítulo 1 Propuesta 1.1 Tema y variable Se analizará la evolución anual de las emisiones de CO₂ per cápita y su relación con el PIB per cápita para países de LATAM (COL, MEX, BRA, CHL, ARG) con datos del Banco Mundial (1960–2022). 1.2 Justificación Relevancia económica-ambiental y de políticas públicas. Valor para decisiones (descarbonización, tendencias de largo plazo). Datos limpios/abiertos, accesibles desde R. 1.3 Fuentes y permisos World Development Indicators — CC BY 4.0 CO₂ per cápita: EN.ATM.CO2E.PC (o cálculo desde EN.ATM.CO2E.KT y SP.POP.TOTL) PIB per cápita: NY.GDP.PCAP.CD 1.4 Entregables Unidad 1 (esta página): Propuesta y fuentes. Unidad 2: Análisis de CO₂ per cápita (promedio móvil, rezagos, estacionalidad). "],["unidad-2-análisis-temporal-pib-per-cápita.html", "Capítulo 2 Unidad 2 — Análisis temporal (PIB per cápita) 2.1 Librerías 2.2 Descarga y preparación de PIB per cápita (serie estable) 2.3 Serie principal (Colombia) y gráfico base 2.4 Promedio móvil (suavizamiento) 2.5 Rezagos y ACF (dependencia temporal) 2.6 Estacionalidad (discusión)", " Capítulo 2 Unidad 2 — Análisis temporal (PIB per cápita) En esta unidad se realiza un análisis exploratorio de PIB per cápita (Banco Mundial, 1960–2022) para países LATAM (COL, MEX, BRA, CHL, ARG), con: - Promedio móvil (suavizamiento), - Rezagos y ACF (dependencia temporal), - Discusión de estacionalidad (serie anual, no hay estacionalidad intra-anual). Nota: El API del Banco Mundial está devolviendo intermitentemente “indicator not found” para CO₂. Para no bloquear la entrega, la serie principal de la Unidad 2 será PIB per cápita (NY.GDP.PCAP.CD). Al final añadimos un chunk opcional que intenta traer CO₂ per cápita (EN.ATM.CO2E.PC) con códigos de país en mayúsculas; si funciona, se muestra un gráfico PIB–CO₂ como “tiempo variable complementaria”. Si no, la compilación no se rompe. 2.1 Librerías library(WDI) # fuente Banco Mundial (WDI) library(wbstats) # otra interfaz al API del Banco Mundial library(dplyr) library(ggplot2) library(zoo) 2.2 Descarga y preparación de PIB per cápita (serie estable) # Descargar PIB per cápita (US$ actuales) por país, garantizando MAYÚSCULAS paises &lt;- c(&quot;COL&quot;,&quot;MEX&quot;,&quot;BRA&quot;,&quot;CHL&quot;,&quot;ARG&quot;) years &lt;- 1960:2022 get_gdp_pc &lt;- function(cc) { WDI(country = toupper(cc), indicator = c(gdp = &quot;NY.GDP.PCAP.CD&quot;), start = min(years), end = max(years)) } lst_gdp &lt;- lapply(paises, get_gdp_pc) dat_gdp &lt;- bind_rows(lst_gdp) # Limpiar y ordenar dat_gdp &lt;- dat_gdp %&gt;% transmute(country, iso2c, iso3c, year = as.integer(year), gdp) %&gt;% arrange(country, year) # Verificación rápida stopifnot(&quot;gdp&quot; %in% names(dat_gdp)) head(dat_gdp) ## country iso2c iso3c year gdp ## 1 Argentina AR ARG 1960 778.2517 ## 2 Argentina AR ARG 1961 971.3380 ## 3 Argentina AR ARG 1962 870.2175 ## 4 Argentina AR ARG 1963 852.9724 ## 5 Argentina AR ARG 1964 1176.2009 ## 6 Argentina AR ARG 1965 1281.8334 range(dat_gdp$year) ## [1] 1960 2022 2.3 Serie principal (Colombia) y gráfico base gdp_col &lt;- dat_gdp %&gt;% filter(country == &quot;Colombia&quot;) %&gt;% arrange(year) ggplot(gdp_col, aes(year, gdp)) + geom_line(linewidth = 1, color = &quot;steelblue&quot;) + geom_point(size = 1.5) + labs(title = &quot;PIB per cápita — Colombia (1960–2022)&quot;, x = &quot;Año&quot;, y = &quot;US$ actuales por persona&quot;) + theme_minimal() 2.4 Promedio móvil (suavizamiento) gdp_col &lt;- gdp_col %&gt;% mutate(ma5 = zoo::rollmean(gdp, k = 5, fill = NA, align = &quot;right&quot;)) ggplot(gdp_col, aes(year)) + geom_line(aes(y = gdp), color = &quot;gray60&quot;) + geom_line(aes(y = ma5), color = &quot;red&quot;, linewidth = 1) + labs(title = &quot;PIB per cápita y promedio móvil (5 años)&quot;, x = &quot;Año&quot;, y = &quot;US$ actuales por persona&quot;) + theme_minimal() ## Warning: Removed 4 rows containing missing values or values outside the scale range (`geom_line()`). 2.5 Rezagos y ACF (dependencia temporal) gdp_col &lt;- gdp_col %&gt;% mutate(gdp_lag1 = dplyr::lag(gdp, 1)) ggplot(gdp_col, aes(gdp_lag1, gdp)) + geom_point() + geom_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;red&quot;) + labs(title = &quot;PIB per cápita: gdp(t) vs gdp(t−1)&quot;, x = &quot;PIB per cápita año t−1&quot;, y = &quot;PIB per cápita año t&quot;) + theme_minimal() ## `geom_smooth()` using formula = &#39;y ~ x&#39; ## Warning: Removed 1 row containing non-finite outside the scale range (`stat_smooth()`). ## Warning: Removed 1 row containing missing values or values outside the scale range (`geom_point()`). ts_gdp &lt;- ts(gdp_col$gdp, start = min(gdp_col$year), frequency = 1) acf(ts_gdp, main = &quot;ACF — PIB per cápita (anual)&quot;) 2.6 Estacionalidad (discusión) La serie es anual (frecuencia 1), por lo que no existe estacionalidad intra-anual. La dinámica observable es de tendencia/ciclos de largo plazo. Para estacionalidad clásica se requerirían datos mensuales o trimestrales. ## Tiempo como variable complementaria: PIB vs CO₂ # Tiempo como variable complementaria: PIB vs CO₂ show_co2_plot &lt;- FALSE # Intento 1: CO₂ per cápita directo por país (códigos MAYÚSCULAS) safe_get_pc &lt;- function(cc) { try( wb_data( indicator = c(co2 = &quot;EN.ATM.CO2E.PC&quot;), country = toupper(cc), start_date = min(years), end_date = max(years), return_wide = TRUE ), silent = TRUE ) } lst_co2 &lt;- lapply(paises, safe_get_pc) # Validar que al menos uno devolvió &#39;co2&#39; con datos no-NA valid_frames &lt;- lapply(lst_co2, function(x) { is.data.frame(x) &amp;&amp; &quot;co2&quot; %in% names(x) &amp;&amp; any(!is.na(x$co2)) }) if (any(unlist(valid_frames))) { co2_ok &lt;- bind_rows(lst_co2[unlist(valid_frames)]) %&gt;% transmute(country, iso2c, iso3c, year = as.integer(date), co2) %&gt;% arrange(country, year) # Unir con PIB dat_join &lt;- inner_join(co2_ok, dat_gdp, by = c(&quot;country&quot;,&quot;iso2c&quot;,&quot;iso3c&quot;,&quot;year&quot;)) if (nrow(dat_join) &gt; 0) { show_co2_plot &lt;- TRUE co2_countries &lt;- intersect(unique(dat_join$country), unique(dat_gdp$country)) message(&quot;CO₂ disponible para: &quot;, paste(co2_countries, collapse = &quot;, &quot;)) ggplot(dat_join %&gt;% filter(country %in% co2_countries), aes(gdp, co2, group = country, color = year)) + geom_path(linewidth = 1) + scale_x_log10() + labs(title = &quot;PIB per cápita vs CO₂ per cápita (si API responde)&quot;, x = &quot;PIB per cápita (US$ actuales, log)&quot;, y = &quot;CO₂ per cápita (t/persona·año)&quot;) + theme_minimal() } } if (!show_co2_plot) { message(&quot;No se pudo obtener CO₂ per cápita en este intento; el análisis principal usa PIB per cápita.&quot;) } ## No se pudo obtener CO&lt;U+2082&gt; per c&lt;U+00E1&gt;pita en este intento; el an&lt;U+00E1&gt;lisis principal usa PIB per c&lt;U+00E1&gt;pita. "]]
